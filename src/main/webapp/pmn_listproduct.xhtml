<ui:composition template="template/lnf-template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="body">
        <f:metadata>
            <f:event type="preRenderView" listener="#{login.grantPermission}"/>
        </f:metadata>
        <div class="card">
            <h:form>
                <h2 align="center">DANH SÁCH CÁC SẢN PHẨM</h2>
                <hr/>
                <div>
                    <p:inputText id="key" placeholder="Nhập tìm kiếm"/>
                    <p:commandButton value="Tìm kiếm"/>
                </div>
                <hr/>
                <p:dataTable var="sp" value="#{sanPhamBean.sanPhams}">
                    <p:column style="width: 5%; text-align: center" headerText="Mã">
                        <h:outputText value="#{sp.maSanPham}"/>
                    </p:column>
                    <p:column style="width: 11%" headerText="Hình ảnh">
                        <p:graphicImage value="images/#{sp.hinhAnh}" style="width: 75px; height: 75px"/>
                    </p:column>
                    <p:column style="width: 21%" headerText="Tên sản phẩm">
                        <h:outputText value="#{sp.tenSanPham}"/>
                    </p:column>
                    <p:column style="width: 9%" headerText="Đơn giá">
                        <h:outputText value="#{sp.donGia}"/>
                    </p:column>
                    <p:column style="width: 8%; text-align: center" headerText="Số lượng">
                        <h:outputText value="#{sp.soLuongCoSan}"/>
                    </p:column>
                    <p:column style="width: 9%" headerText="Danh mục">
                        <h:outputText value="#{sp.danhMuc.tenDanhmuc}"/>
                    </p:column>
                    <p:column style="width: 15%; text-align: center" headerText="Tình trạng">
                        <h:outputText value="#{sp.trangThai}"/>
                    </p:column>
                    <p:column style="width: 18%; text-align: center" headerText="">
                        <p:commandButton icon="pi pi-pencil" onclick="PF('dlgpencil').show()" update=":details"
                                         style="margin-left: 5px; margin-right: 5px">
                            <f:setPropertyActionListener value="#{sp}" target="#{sanPhamBean.selectedSanPham}"/>
                        </p:commandButton>
                        <p:commandButton icon="pi pi-trash" onclick="PF('dlgtrash').show()"
                                         styleClass="ui-button-danger">
                            <f:setPropertyActionListener value="#{sp}" target="#{sanPhamBean.selectedSanPham}"/>
                        </p:commandButton>
                    </p:column>
                </p:dataTable>
                <hr/>
                <p:commandButton resetValues="true" value="Thêm sản phẩm mới"
                                 action="#{sanPhamBean.nextPageCreate}"/>
            </h:form>

            <!--dialog xóa sản phẩm-->
            <p:dialog header="Xác nhận" widgetVar="dlgtrash" minHeight="40" width="300" showEffect="fade"
                      modal="true">
                <p class="p-m-0">Chắc chắn xóa sản phẩm ?</p>
                <f:facet name="footer">
                    <p:commandButton value="Đồng ý" styleClass="ui-button-warning"
                                     action="#{sanPhamBean.deleteSanPham(sanPhamBean.selectedSanPham)}"/>
                    <p:commandButton value="Bỏ qua" onclick="PF('dlgtrash').hide()"/>
                </f:facet>
            </p:dialog>

            <!--dialog xem chi tiết - chỉnh sửa sản phẩm-->
            <p:dialog header="Chi tiết sản phẩm" showEffect="fade" modal="true"
                      widgetVar="dlgpencil" hideEffect="fade" resizable="false">
                <h:form id="details">
                    <p:outputPanel id="manage-product-content" class="ui-fluid">
                        <p:panelGrid>
                            <p:row>
                                <p:column>
                                    <p:outputLabel value="Mã sản phẩm:"/>
                                    <p:inputText readonly="true" value="#{sanPhamBean.selectedSanPham.maSanPham}"/>
                                </p:column>
                                <p:column>
                                    <p:outputLabel for="tensp" value="Tên sản phẩm:"/>
                                    <p:inputText id="tensp" value="#{sanPhamBean.selectedSanPham.tenSanPham}"/>
                                </p:column>
                                <p:column>
                                    <p:outputLabel for="xx" value="Xuất xứ:"/>
                                    <p:inputText id="xx" value="#{sanPhamBean.selectedSanPham.xuatXu}"/>
                                </p:column>
                                <p:column>
                                    <p:outputLabel value="Danh mục:"/>
                                    <p:inputText value="#{sanPhamBean.selectedSanPham.danhMuc.tenDanhmuc}"/>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column style="text-align: center">
                                    <p:graphicImage value="images/#{sanPhamBean.selectedSanPham.hinhAnh}"
                                                    style="width: 250px; height: 250px;"/>
                                </p:column>
                                <p:column colspan="3">
                                    <p:outputLabel value="Mô tả sản phẩm:"/><br/>
                                    <p:inputTextarea rows="11" value="#{sanPhamBean.selectedSanPham.moTaSanPham}"/>
                                </p:column>
                            </p:row>
                            <br/>
                            <p:row>
                                <p:column>
                                    <p:outputLabel for="dg" value="Đơn giá:"/>
                                    <p:inputText id="dg" value="#{sanPhamBean.selectedSanPham.donGia}"/>
                                </p:column>
                                <p:column>
                                    <p:outputLabel value="Số lượng có sẵn:"/>
                                    <p:inputText readonly="true" value="#{sanPhamBean.selectedSanPham.soLuongCoSan}"/>
                                </p:column>
                                <p:column>
                                    <p:outputLabel for="tt" value="Trạng thái:"/>
                                    <p:inputText id="tt" value="#{sanPhamBean.selectedSanPham.trangThai}"/>
                                </p:column>
                                <p:column>
                                    <p:commandButton value="Lưu" action="#{sanPhamBean.updateSanPham}"
                                                     update=":details"/>
                                </p:column>
                            </p:row>
                        </p:panelGrid>
                    </p:outputPanel>
                </h:form>
                <f:facet name="footer">
                    <p:commandButton value="Đóng" onclick="PF('dlgpencil').hide()" class="ui-button-danger"
                                     style="margin-right: 10px"/>
                </f:facet>
            </p:dialog>
        </div>
    </ui:define>
</ui:composition>


